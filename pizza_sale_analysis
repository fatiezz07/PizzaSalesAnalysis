SELECT * from pizza_sales

-- Daily Trend
SELECT DATENAME(DW, order_date) as order_day, COUNT(DISTINCT order_id) as Total_orders
from pizza_sales
Group by DATENAME(DW, order_date)

-- Hourly Trend
SELECT DATEPART(HOUR, order_time) as order_hours, COUNT(DISTINCT order_id) as Total_orders
From pizza_sales
Group by DATEPART(HOUR, order_time)
order by DATEPART(HOUR, order_time)

-- Percentage of Sales by Pizza category
SELECT pizza_category, sum(total_price) as Total_sales, sum(total_price) * 100 / 
(SELECT sum(total_price) from pizza_sales Where MONTH(order_date) = 1) as Total_sales
From pizza_sales 
Where MONTH(order_date) = 1
Group by pizza_category

-- Percentage of Sales by Pizza Size
SELECT pizza_size, CAST(sum(total_price) AS DECIMAL (10,2) ) as Total_sales, CAST( sum(total_price) * 100 / 
(SELECT sum(total_price) from pizza_sales Where DATEPART(quarter, order_date) = 1 ) AS DECIMAL (10, 2)) as Total_sales
From pizza_sales
Where DATEPART(quarter, order_date) = 1
Group by pizza_size
Order by pizza_size

-- Total Pizzas Sold by Pizza Category
SELECT pizza_category, sum(quantity) as Total_Pizzas_Sold
From pizza_sales
Group by pizza_category

--Top 5 Best Seller Pizzas
SELECT TOP 5 pizza_name, sum(quantity) as Total_Pizzas_Sold
From pizza_sales
Group by pizza_name
Order by sum(quantity) DESC

-- Bottom 5 Worst Seller Pizzas
SELECT TOP 5 pizza_name, sum(quantity) as Total_Pizzas_Sold
From pizza_sales
Where MONTH (order_date) = 1
Group by pizza_name
Order by sum(quantity)
